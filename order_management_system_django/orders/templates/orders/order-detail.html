{% extends 'base.html' %}

{% load orders_filters %}

{% block body %}

    <div>
        <ul>
            <li>
                Id заказа: {{ order.pk }}
            </li>
            <li>
                Номер стола: {{ order.table_number }}
            </li>
            <li>
                Позиции:
                <ul>
                    {% for item in order.items.all %}
                        <li>{{ item.title }} - {{ pk_price_dict|get:item.pk }} шт. по {{ item.price }}</li>
                    {% endfor %}
                </ul>
                {% if order.status == order.PENDING %}
                    <a href="{% url 'orders:change-order-items' order.pk %}">Изменить блюда в заказе</a>
                {% endif %}

            </li>
            <li>
                Общая стоимость: {{ order.total_price }} Р
            </li>
            <li>
                Статус заказа: {{ order.get_status_display }}
            </li>
        </ul>
    </div>

    <form method="post" action="{% url 'orders:order_delete' order.pk %}">
        {% csrf_token %}
        <button>Удалить заказ</button>
    </form>

    <form method="post" action="{% url 'orders:order_change_status' order.pk %}">
        {% csrf_token %}
        {% if order.status != 0 %}
            <button>Перевести в ожидание</button>
        {% endif %}
        {% if order.status != 1 %}
            <button name="ready">Заказ готов!</button>
        {% elif order.status != 2 %}
            <button name="paid">Заказ оплачен!</button>
        {% endif %}
    </form>
{% endblock %}
